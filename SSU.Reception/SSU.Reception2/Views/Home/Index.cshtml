@model SSU.Reception.Models.RatingViewModel

@{
    ViewBag.Title = "Главная";
}

<div class="panel panel-info">
    <div class="panel-heading">
        Список абитуриентов на @DateTime.Now
    </div>
    <div class="panel-body">
        <form method="get">
            <div class="form-inline" style="justify-content: space-between; display: flex">
                <input id="contact-filter" style="display: inline-flex" class="form-control" type="text" placeholder="Поиск..">
                <div class="form-group">
                    <input class="form-check-input" type="checkbox" id="checkbox-filter" value="option1">
                    <label class="form-check-label" for="checkbox-filter">Не показывать неактивных абитуриентов</label>
                </div>
                <div class="form-group">
                    <input class="form-check-input" type="checkbox" id="checkbox-filter-certificate" value="option1">
                    <label class="form-check-label" for="checkbox-filter">Оригинал аттестата</label>
                </div>
                <input type="submit" value="Применить" class="btn btn-success" />
            </div>
        </form>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                @{
                    int dirCount = Model.SortedDirections.Count;
                }
                <th id="index" rowspan="2">#</th>
                <th colspan="@dirCount.ToString()">Общий список направлений и позиция на этом направлении в общем списке</th>
                <th id="first_status" rowspan="2">Статус в приказе после 29 июля и 1 августа</th>
                <th id="FIO" rowspan="2">ФИО</th>
                <th id="second_status" rowspan="2">Статус поступления</th>
                <th id="original_direction" rowspan="2">Направление, на котором лежит оригинал</th>
                <th id="first_priority" rowspan="2">1-й приоритет</th>
                <th id="second_priority" rowspan="2">2-й приоритет</th>
                <th id="third_priority" rowspan="2">3-й приоритет</th>
                <th id="point_sum" rowspan="2">Общая сумма баллов</th>
                <th colspan="3">Баллы ЕГЭ</th>
                <th id="medal_point" rowspan="2">Баллы за медаль</th>
                <th id="dop_point" rowspan="2">Доп. баллы</th>
                <th id="original_status" rowspan="2">Статус оригинала</th>
                <th id="change_column" rowspan="2">Изменить</th>
                <th id="delete_column" rowspan="2">Удалить</th>
            </tr>
            <tr>
                @{
                    foreach (var direction in Model.SortedDirections.Keys)
                    {
                        <th>@direction.Name</th>
                    }
                }
                <th>И</th>
                <th>М</th>
                <th>Р</th>
            </tr>
        </thead>
        @{
            int i = 1;
        }
        @foreach (var item in Model.Enrollees)
        {
    <tr>
        <td>@i</td>
        @{
            i++;
        }
        <!-- Общий список направлений и позиция на этом направлении в общем списке -->
        @{
            foreach (var direction in Model.SortedDirections)
            {
                var index = direction.Value.IndexOf(item) + 1;
                if (index != 0)
                {
                    <td>@index</td>
                }
                else
                {
                    <td></td>
                }
            }
        }
        <!-- Статус в приказе после 29 июля и 1 августа -->
        <td>
            @Html.DisplayFor(modelItem => item.EnrollmentStatus)
        </td>
        <!-- ФИО -->
        <td>
            @Html.DisplayFor(modelItem => item.Surname)
            @Html.DisplayFor(modelItem => item.Name)
            @Html.DisplayFor(modelItem => item.Patronymic)
        </td>
        <!-- Статус поступления -->
        <td>
            @Html.DisplayFor(modelItem => item.GetReceiptStatus)
        </td>
        <!-- Направление, на котором лежит оригинал -->
        <td>
            @Html.DisplayFor(modelItem => item.FirstPriority.Name)
        </td>
        <!-- 1-й приоритет -->
        <td>
            @Html.DisplayFor(modelItem => item.FirstPriority.Name)
        </td>
        <!-- 2-й приоритет -->
        <td>
            @Html.DisplayFor(modelItem => item.SecondPriority.Name)
        </td>
        <!-- 3-й приоритет -->
        <td>
            @Html.DisplayFor(modelItem => item.ThirdPriority.Name)
        </td>
        <!-- Общая сумма баллов -->
        <td>
            @Html.DisplayFor(modelItem => item.TotalPoints)
        </td>
        <!-- Баллы ЕГЭ -->
        <td>
            @Html.DisplayFor(modelItem => item.CSScore)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.MathScore)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.RussianScore)
        </td>
        <!-- Баллы за медаль -->
        <td>
            @Html.DisplayFor(modelItem => item.HasMedal)
        </td>
        <!-- Доп. баллы -->
        <td>
            @Html.DisplayFor(modelItem => item.ExtraPoints)
        </td>
        <!-- Статус оригинала -->
        <td>
            @Html.DisplayFor(modelItem => item.OriginalCertificate)
        </td>

        <!-- Статус зачисления в другом вузе -->
        @*<td></td>*@

        <!-- Изменить -->
        <td>
            @Html.ActionLink("Изменить", "Edit", "Enrollees", new { id = item.Id }, null)
        </td>
        <!-- Удалить -->
        <td>
            @Html.ActionLink("Удалить", "Delete", "Enrollees", new { id = item.Id }, null)
        </td>
    </tr>
        }
    </table>
</div>

<div style="justify-content: center; width: 100%; margin:15px 15px 2px 4px;">
    @SSU.Reception.Helpers.HtmlHelperExtension.PagingPrev(Html, (int)ViewData["PageNum"])
    @SSU.Reception.Helpers.HtmlHelperExtension.PagingNext(Html, (int)ViewData["PageNum"], (int)ViewData["ItemsCount"], (int)ViewData["PageSize"])
</div>